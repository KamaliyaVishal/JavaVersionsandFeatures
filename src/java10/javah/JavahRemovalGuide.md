# Java 10 javah Tool Removal Guide

The `javah` tool has been removed in Java 10. Its functionality has been integrated into the `javac` compiler.

## Overview

**javah** was a standalone tool for generating C header files from Java classes. In Java 10, this functionality is now part of `javac`.

## Migration from javah to javac

### Before Java 10 (Using javah)

```bash
# Generate header file for a class
javah -o MyClass.h com.example.MyClass

# Generate header files for multiple classes
javah -o output.h com.example.Class1 com.example.Class2

# Generate to a directory
javah -d ./headers com.example.MyClass
```

### Java 10+ (Using javac)

```bash
# Generate header file using javac
javac -h <output_directory> MyClass.java

# Example: Generate header in ./headers directory
javac -h ./headers com/example/MyClass.java
# Generates: headers/com_example_MyClass.h

# For multiple classes
javac -h ./headers com/example/Class1.java com/example/Class2.java
```

## Key Differences

### javah (Removed)
- Standalone tool
- Separate command
- Required compiled .class files
- Command: `javah [options] <classes>`

### javac -h (Java 10+)
- Integrated into javac
- Part of compilation process
- Works with .java source files
- Command: `javac -h <directory> <source-files>`

## Examples

### Example 1: Basic Header Generation

**MyClass.java:**
```java
package com.example;

public class MyClass {
    public native void nativeMethod();
    public native int calculate(int a, int b);
}
```

**Java 10+ Command:**
```bash
javac -h ./headers com/example/MyClass.java
```

**Generated Header (headers/com_example_MyClass.h):**
```c
/* DO NOT EDIT THIS FILE - it is machine generated */
#include <jni.h>
/* Header for class com_example_MyClass */

#ifndef _Included_com_example_MyClass
#define _Included_com_example_MyClass
#ifdef __cplusplus
extern "C" {
#endif
/*
 * Class:     com_example_MyClass
 * Method:    nativeMethod
 * Signature: ()V
 */
JNIEXPORT void JNICALL Java_com_example_MyClass_nativeMethod
  (JNIEnv *, jobject);

/*
 * Class:     com_example_MyClass
 * Method:    calculate
 * Signature: (II)I
 */
JNIEXPORT jint JNICALL Java_com_example_MyClass_calculate
  (JNIEnv *, jobject, jint, jint);

#ifdef __cplusplus
}
#endif
#endif
```

### Example 2: Build Script Migration

**Old Build Script (Java 9 and earlier):**
```bash
#!/bin/bash
# Compile Java
javac -d classes src/**/*.java

# Generate headers
javah -d headers -classpath classes com.example.MyClass
```

**New Build Script (Java 10+):**
```bash
#!/bin/bash
# Compile Java and generate headers in one step
javac -d classes -h headers src/**/*.java
```

### Example 3: Maven Integration

**pom.xml (Java 10+):**
```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>3.8.1</version>
    <configuration>
        <source>10</source>
        <target>10</target>
        <compilerArgs>
            <arg>-h</arg>
            <arg>${project.build.directory}/generated-headers</arg>
        </compilerArgs>
    </configuration>
</plugin>
```

### Example 4: Gradle Integration

**build.gradle (Java 10+):**
```gradle
compileJava {
    options.compilerArgs += ['-h', file('src/main/headers')]
}
```

## Benefits of Integration

1. **Unified Tooling**: One tool instead of two
2. **Better Integration**: Works seamlessly with build systems
3. **Simplified Workflow**: Compile and generate headers in one step
4. **Consistency**: Same tool for compilation and header generation

## Common Use Cases

### JNI Development

```bash
# Complete workflow
# 1. Write Java class with native methods
# 2. Compile and generate header
javac -h ./jni com/example/NativeClass.java

# 3. Implement native method in C/C++
# 4. Compile native library
# 5. Load and use in Java
```

### Native Interface Generation

```bash
# Generate headers for entire package
javac -h ./headers com/example/native/*.java
```

## Troubleshooting

### Error: javah: command not found

**Solution**: Use `javac -h` instead of `javah`

```bash
# Wrong (Java 10+)
javah -d headers com.example.MyClass

# Correct (Java 10+)
javac -h headers com/example/MyClass.java
```

### Header Not Generated

**Check:**
1. Ensure class has `native` methods
2. Verify output directory exists or is writable
3. Check compilation errors

```bash
# Verbose output
javac -h ./headers -verbose com/example/MyClass.java
```

## Migration Checklist

- [ ] Replace `javah` commands with `javac -h`
- [ ] Update build scripts (Makefile, build.sh, etc.)
- [ ] Update Maven/Gradle configurations
- [ ] Update CI/CD pipelines
- [ ] Update documentation
- [ ] Test header generation
- [ ] Verify native code compilation still works

## Notes

- **Backward Compatibility**: Old `javah` commands won't work in Java 10+
- **Functionality**: Header generation is identical, just different command
- **Build Systems**: Most build tools have been updated to support `javac -h`
- **No Functional Changes**: Generated headers are identical to javah output

## Resources

- JEP 313: Remove the javah Tool
- Java Native Interface (JNI) Documentation
- javac Documentation

